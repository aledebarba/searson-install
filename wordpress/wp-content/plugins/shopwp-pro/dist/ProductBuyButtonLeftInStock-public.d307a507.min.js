"use strict";(self.webpackChunkshopwp=self.webpackChunkshopwp||[]).push([["ProductBuyButtonLeftInStock-public"],{iEbB:function(e,t,n){n.r(t),n.d(t,{default:function(){return O}});var r=n("raWh"),o=n("XUG9"),i=n("XTMG"),a=n("81/l"),c={name:"17sxv2k-textNoticeCSS",styles:"text-align:center;margin:5px auto 2.4em auto;font-size:15px;padding:10px;color:red;width:calc(100% - 30px);font-weight:normal;display:block;label:textNoticeCSS;"};function s(e){var t=e.quantityLeft,n=c;return(0,i.tZ)("span",{className:"wps-notice-text",css:[n,a.P6,";label:ProductBuyButtonTextNotice;"]},wp.i18n.sprintf(wp.i18n.__("Only %s left!","wpshopify"),t))}var l=n("ORdK"),u=n("vzV8"),f=n("E5I5"),p=n("VwHb"),d=n.n(p),y=n("+NB1"),v=n.n(y),b=n("SRd1"),w=n("vjfk");function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var O=function(e){var t=e.payload,n=e.payloadSettings,i=e.selectedVariant,a=e.isTouched,c=e.allOptionsSelected,p=wp.element,y=p.useEffect,O=p.useState,g=O(!1),m=(0,o.Z)(g,2),S=m[0],P=m[1],j=O("idle"),k=(0,o.Z)(j,2),x=k[0],N=k[1],I=O(!1),E=(0,o.Z)(I,2),B=E[0],Z=E[1],J=(0,b.Z)();function L(e){return e&&e.variants?e.variants.edges.map((function(e){return e.node.id})):[]}return(0,w.useQuery)("inventory-"+t.title,(function(){var e=L(t),n=(0,u.lJ)("wps-inventory-levels");if(e.length)return n&&(n=JSON.parse(n),!(e=(0,f.Xd)(n,e)).length)?(N("resolved"),Z(n),Promise.resolve({data:n,cached:!0})):(0,u.$x)({ids:L(t)});console.warn("WP Shopify warning: No variant ids found for fetchVariantInventoryManagement")}),function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({enabled:a&&"idle"===x,onError:function(e){N("error")},onSuccess:function(e){if(N("resolved"),!v()(e,"cached")){if(v()(e,"data")&&(e=e.data),v()(e,"type")&&"error"===e.type)return N("error"),void console.warn("WP Shopify warning: No inventory was fetched because of error: "+e.message);var t=(0,u.lJ)("wps-inventory-levels");t=!!t&&JSON.parse(t);var n=function(e){if(v()(e,"data"))var t=e.data;else t=e;return Array.isArray(t)?!t||t.length<=0?[]:t.map((function(e){return!!e&&{id:btoa(e.id),tracked:!!v()(e,"inventoryItem")&&e.inventoryItem.tracked,inventoryLevels:!!v()(e,"inventoryItem")&&e.inventoryItem.inventoryLevels,inventoryPolicy:e.inventoryPolicy}})):[]}(e),r=d()(n,t,"id");(0,u.K7)("wps-inventory-levels",JSON.stringify(r)),Z(n)}}},u.li)),y((function(){if(J.current&&i){if(i.node.availableForSale){var e=(0,l.Qe)(B,i.node.id,n.leftInStockThreshold);e||P(!1),P(e)}}else P(!1)}),[i]),S&&c&&React.createElement(s,{quantityLeft:S})}}}]);